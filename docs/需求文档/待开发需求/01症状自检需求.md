一、症状自检助手模块
1. 需求分析
   目标：用户输入症状关键词，系统匹配疾病库中的症状描述，返回关联疾病列表
   技术依赖：
   疾病表 illness（字段 illness_symptom）
   用户表 user（外键约束）
   功能边界：
   游客/用户可查询，仅记录登录用户的搜索历史
2. 表结构修改
   -- 新增症状搜索记录表（与现有表兼容）
   CREATE TABLE `symptom_log` (
   `id` int NOT NULL AUTO_INCREMENT,
   `user_id` int DEFAULT NULL COMMENT '游客无user_id',
   `keyword` varchar(255) NOT NULL COMMENT '症状关键词',
   `matched_illness_ids` varchar(255) DEFAULT NULL COMMENT '逗号分隔的疾病ID',
   `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
   PRIMARY KEY (`id`),
   KEY `fk_user_id` (`user_id`),
   CONSTRAINT `fk_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
4. 接口设计
   // 症状匹配接口（兼容游客）
   @PostMapping("/symptom/search")
   public Result<List<Illness>> searchSymptoms(
   @RequestParam String keyword,
   @RequestHeader(required = false) String token) {

   // 1. 分词处理（示例："头痛 发热" -> ["头痛","发热"]）
   List<String> keywords = Arrays.asList(keyword.split(" "));

   // 2. 查询疾病表（使用MyBatis动态SQL）
   List<Illness> illnesses = illnessDao.selectBySymptoms(keywords);

   // 3. 记录日志（仅登录用户）
   if (token != null) {
   User user = jwtUtil.parseToken(token);
   symptomLogService.saveLog(user.getId(), keyword, illnesses);
   }

   return Result.success(illnesses);
   }

// MyBatis映射（resources/mapper/IllnessMapper.xml）
<select id="selectBySymptoms" resultType="Illness">
SELECT * FROM illness
WHERE
<foreach item="kw" collection="keywords" separator=" OR ">
illness_symptom LIKE CONCAT('%', #{kw}, '%')
</foreach>
ORDER BY id DESC LIMIT 10
</select>
5. 前端实现
   // 症状搜索页（symptom.html）
<div class="search-box">
  <input type="text" id="symptomInput" placeholder="输入症状，用空格分隔">
  <button onclick="searchSymptoms()">立即诊断</button>
</div>

// 调用接口
function searchSymptoms() {
const keyword = $('#symptomInput').val();
$.post('/symptom/search', { keyword }, res => {
res.data.forEach(illness => {
$('#resultList').append(`
        <div class="illness-item">
          <a href="/illness/detail/${illness.id}">${illness.illnessName}</a>
          <p>${illness.illnessSymptom.substring(0, 50)}...</p>
        </div>
      `);
});
});
}

6. 排期与交付物
健康档案	用户表结构扩展	0.5天	数据库变更脚本
健康数据管理功能	1天	health.html + 健康计算逻辑
联调测试	模块集成测试	1天	测试报告