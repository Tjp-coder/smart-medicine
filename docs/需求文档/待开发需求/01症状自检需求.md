一、症状自检助手模块
1. 需求分析
   目标：用户输入症状关键词，系统匹配疾病库中的症状描述，返回关联疾病列表
   技术依赖：
   疾病表 illness（字段 illness_symptom）
   用户表 user（外键约束）
   功能边界：
   游客/用户可查询，仅记录登录用户的搜索历史
2. 表结构修改
   -- 新增症状搜索记录表（与现有表兼容）
   CREATE TABLE `symptom_log` (
   `id` int NOT NULL AUTO_INCREMENT,
   `user_id` int DEFAULT NULL COMMENT '游客无user_id',
   `keyword` varchar(255) NOT NULL COMMENT '症状关键词',
   `matched_illness_ids` varchar(255) DEFAULT NULL COMMENT '逗号分隔的疾病ID',
   `create_time` datetime DEFAULT CURRENT_TIMESTAMP,
   PRIMARY KEY (`id`),
   KEY `fk_user_id` (`user_id`),
   CONSTRAINT `fk_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
4. 接口设计
   // 症状匹配接口（兼容游客）
   @PostMapping("/symptom/search")
   public Result<List<Illness>> searchSymptoms(
   @RequestParam String keyword,
   @RequestHeader(required = false) String token) {

   // 1. 分词处理（示例："头痛 发热" -> ["头痛","发热"]）
   List<String> keywords = Arrays.asList(keyword.split(" "));

   // 2. 查询疾病表（使用MyBatis动态SQL）
   List<Illness> illnesses = illnessDao.selectBySymptoms(keywords);

   // 3. 记录日志（仅登录用户）
   用的session LoginUser属性保存的登录信息

   return Result.success(illnesses);
   }


5. 前端实现

6. 排期与交付物
   模块	任务	工期	交付物
   症状自检	后端接口开发	1.5天	可查询的REST API
   前端交互实现	1天	symptom.html页面

# 症状自检功能需求文档

## 功能概述
新增“症状自检”功能模块，用户可以通过前端入口进入该模块，查看、搜索、保存和删除自己的症状信息。以下是具体需求描述。

---

## 功能流程

### 1. 用户进入“症状自检”模块
- **展示内容**：
   - 如果用户已有症状信息：
      - 展示症状信息列表，每条信息包含以下字段：`id`、`关键词`、`疾病名称`（通过疾病 ID 查询得到，显示一条记录，如果是多条数据则...显示）、`创建日期`。
      - 每条信息后提供【查】和【删】操作按钮。
   - 如果用户无症状信息：
      - 提示“无数据，请先进行症状自检”。

- **关键词输入框**：
   - 数据列上方提供一个关键词输入框。
   - 如果关键词为空，点击【症状自检】按钮时提示“请输入关键词”。
   - 输入关键词后，点击【症状自检】按钮，触发后续流程。

### 2. 症状自检流程
- **弹窗提示**：
   - 点击【症状自检】按钮后，弹出一个弹窗，显示“自检中请稍后...”。
   - 等待 2 秒后，展示结果：“根据你的症状，你的疾病推测出可能是 xxx、xxx”。
   - 弹窗底部提供两个按钮：【保存】和【取消】。

- **保存操作**：
   - 点击【保存】按钮：
      - 保存用户的症状信息，包括以下字段：
         - `id`：症状ID。
         - `user_id`：用户 ID。
         - `keyword`：用户输入的关键词。
         - `matched_illness_ids`：匹配到的疾病 ID 列表。
         - `create_time`：创建时间。
   - 点击【取消】按钮：
      - 关闭弹窗，不保存任何信息。

### 3. 疾病列表页
- **表头字段**：
   - `id`：症状记录的唯一标识。
   - `关键词`：用户输入的关键词。
   - `疾病名称`：通过疾病 ID 查询得到的疾病名称。
   - `创建日期`：记录创建的时间。

- **操作按钮**：
   - 【查】：跳转到详情页面。
   - 【删】：删除该条症状记录。

### 4. 症状详情页
- **展示内容**：
   - 展示症状详情，包括以下信息：
      - 关键词。
      - 匹配到的疾病名称（以超链接形式展示）。
   - 点击疾病名称超链接：
      - 跳转到对应疾病的详情页（系统已实现，调用 `SystemController.java` 中的 `findIllnessOne` 方法）。

### 5. 删除症状信息
- 用户点击【删】按钮时：
   - 根据前端传递的症状记录 ID，删除对应的症状信息。

---

## 接口功能描述

### 1. 症状搜索接口
- **功能**：
   - 用户通过关键词模糊匹配查询疾病表中的疾病症状。
- **请求参数**：
   - `keyword`：用户输入的关键词。
- **返回结果**：
   - 匹配到的疾病列表，包含疾病 ID 和疾病名称。

### 2. 保存症状信息接口
- **功能**：
   - 用户点击【保存】按钮时，保存症状信息。
- **请求参数**：
   - `id`：症状ID。
   - `user_id`：用户 ID。
   - `keyword`：用户输入的关键词。
   - `matched_illness_ids`：匹配到的疾病 ID 列表。
   - `create_time`：创建时间。
- **返回结果**：
   - 保存成功或失败的状态。

### 3. 删除症状信息接口
- **功能**：
   - 用户点击【删】按钮时，删除指定的症状记录。
- **请求参数**：
   - `id`：症状记录的唯一标识。
- **返回结果**：
   - 删除成功或失败的状态。

---

## 后端实现要求
- 修改现有代码，确保上述接口功能正常调通。
- 在 `SymptomController.java` 中实现相关逻辑,同时遵循开发规范，调用已有方法（如 `findIllnessOne`）完成疾病详情查询。


## 前端实现要求
- 开发一个symptom.html页面，用于展示症状信息列表。疾病名称（通过疾病 ID 查询得到，显示一条记录，如果是多条数据则...显示）。
- 通过每条症状列表记录后面的“小眼睛”图标，可以进入症状详情页面，症状详情页面展示症状详情，包括关键词和匹配到的疾病名称（以超链接形式展示）。点击疾病名称超链接，跳转到对应疾病的详情页。

先不与现有搜索历史表做整合。
1. **关键词分词处理**：用户提到的关键词分词处理是使用空格分割，但实际中可能需要更智能的分词方式，比如中文分词。当前需求中使用空格分割是否足够？是否需要集成分词库？
   这个不知道。简单就好。没学过分词技术。直接拿用户关键词去用模糊匹配 疾病表中的疾病症状即可。
2. **匹配疾病的方式**：需求中提到根据关键词匹配疾病症状，但具体匹配逻辑是模糊匹配还是精确匹配？例如，是否使用LIKE查询，或者在数据库中使用全文索引？
   用like查询即可。
3. **疾病名称显示**：当匹配到多个疾病ID时，需求中要求显示一条记录，如果是多条数据则显示省略号。具体是显示第一个疾病名称，还是其他方式？例如“糖尿病、高血压...”。
   是显示查到的第一个疾病名称。
4. **弹窗中的等待时间**：需求中提到等待2秒后展示结果，是否需要实际的后端处理时间，还是前端模拟延迟？后端处理时间可能因数据量不同而变化，是否需要动态调整？
   前端模拟延迟。
5. **权限控制**：游客是否可以保存症状记录？根据需求，只有登录用户会记录搜索历史，但症状自检的保存操作是否仅限于登录用户？
   仅限于登录用户。可以得到session的 LoginUser属性判断是否登录。
6. **接口安全性**：删除操作是否需要验证用户权限，确保用户只能删除自己的记录？
   只能展示当前登录用户的症状，非登录用户在展示症状列表页面中，会提示去登录。才能症状自检。
7. **前端页面路由**：症状详情页的路由如何设计？是否需要新的页面或复用现有页面？
   有三个页面
   症状列表页（新增页面 symptom-search.html）
   症状详情页（新增页面 symptom-detail.html）
   从症状详情页点击疾病名称跳转至疾病详情。（复用原有的疾病详情页）
8. **错误处理**：例如保存失败时的提示信息，接口异常处理等是否需要详细说明？
